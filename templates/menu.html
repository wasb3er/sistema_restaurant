{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Menú de Platillos</title>

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="{% static 'style.css' %}">
</head>

<body >

<!-- NAVBAR UNIFICADO CON CARRITO -->
<nav class="navbar">
    
    <!-- Marca -->
    <a href="{% url 'index' %}" class="nav-brand">RestFreshCO</a>

    <!-- Enlaces -->
    <div class="nav-links">
        <a href="{% url 'index' %}#inicio">Ordenar</a>
        <a href="{% url 'menu' %}">Ver menú de platillos</a>
        <a href="{% url 'index' %}#favoritos">Favoritos del día</a>
    </div>

    <!-- Contenedor lateral derecho -->
    <div class="nav-right">

        <!-- Carrito -->
        <div class="cart-icon-container" onclick="toggleCarrito()">
            <span id="navbar-total">$0</span>
            <img src="{% static 'img/cart.png' %}" class="cart-icon" alt="Carrito">
        </div>

        <!-- Botón ingresar -->
        <button class="nav-admin" onclick="window.location.href='{% url 'login_general' %}'">
            <img src="/static/icons/badge-account.png" alt="icono usuario">
            Ingresar
        </button>

    </div>
</nav>


<div class="container py-5">

    <div class="row g-4">
        {% for platillo in platillos %}
        <div class="col-md-4">
            <div class="menu-card shadow-sm">

                {% if platillo.imagen %}
                <img src="/media/{{ platillo.imagen }}" class="menu-img" alt="{{ platillo.nombre }}">
                {% else %}
                <img src="{% static 'img/placeholder.png' %}" class="menu-img" alt="Sin imagen">
                {% endif %}

                <h4 class="menu-title">{{ platillo.nombre }}</h4>
                <p class="menu-desc">{{ platillo.descripcion }}</p>

                <div class="menu-info">
                    <span class="menu-price">${{ platillo.precio }}</span>
                    <span class="menu-stock">Disponibles: {{ platillo.cantidad }}</span>
                </div>

                <button class="menu-btn"
                    onclick="agregarAlCarrito({{ platillo.id }}, '{{ platillo.nombre }}', {{ platillo.precio }}, '{{ platillo.imagen }}', {{ platillo.cantidad }})">
                    Agregar
                </button>
            </div>
        </div>
        {% endfor %}
    </div>
</div>

<!-- PANEL DESLIZANTE DEL CARRITO -->
<div id="carrito-overlay" class="carrito-overlay" onclick="toggleCarrito()"></div>

<div id="carrito-panel" class="carrito-panel">
    <div class="carrito-header">
        <h4>Tu Carrito</h4>
        <button class="btn-close" onclick="toggleCarrito()"></button>
    </div>

    <ul id="carrito-lista" class="list-group mb-3"></ul>

    <p class="fw-bold fs-5">Total: $<span id="total">0</span></p>

    <button class="btn btn-success w-100 mb-2" onclick="confirmarPedido()">Confirmar Pedido</button>
    <a href="{% url 'index' %}" class="btn btn-outline-secondary w-100">Volver al inicio</a>
</div>

<!-- =========================
          FOOTER
========================= -->
<footer class="footer">
    <p class="footer-rima">
        “Sabores que enamoran, momentos que perduran.”
    </p>

    <div class="footer-social">
        <a href="https://facebook.com" target="_blank" class="footer-icon">
            <img src="{% static 'icons/facebook.png' %}" alt="Facebook">
        </a>

        <a href="https://instagram.com" target="_blank" class="footer-icon">
            <img src="{% static 'icons/instagram.png' %}" alt="Instagram">
        </a>

        <a href="https://wa.me/56912345678" target="_blank" class="footer-icon">
            <img src="{% static 'icons/whatsapp.png' %}" alt="WhatsApp">
        </a>
    </div>

    <p class="footer-copy">© 2025 Restaurante — Todos los derechos reservados</p>
</footer>


<script src="{% static 'js/index.js' %}"></script>
<script>
function toggleCarrito() {
    document.getElementById("carrito-panel").classList.toggle("open");
    document.getElementById("carrito-overlay").classList.toggle("show");
}
</script>
<script>
document.addEventListener("DOMContentLoaded", () => {
    // Ocultar el botón solo si estamos REALMENTE en /menu/
    if (window.location.pathname === "/menu/") {
        const btnIrMenu = document.getElementById("btnIrMenu");
        if (btnIrMenu) btnIrMenu.classList.add("oculto");
    }
});
</script>
</body>
</html>
